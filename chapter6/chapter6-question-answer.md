# Chapter6 习题与回答

1. [UDP为什么比TCP速度快？为什么UDP比TCP传输数据不可靠？](#udp为什么比tcp速度快为什么udp比tcp传输数据不可靠)
2. [下列不属于UDP特点的是?](#下列不属于udp特点的是)
3. [UDP数据报向对方主机的UDP套接字传输过程中，IP和UDP分别负责哪些部分？](#udp数据报向对方主机的udp套接字传输过程中ip和udp分别负责哪些部分)
4. [UDP一般比TCP快，但根据交换数据的特点，其差异可大可小。请说明何种情况下UDP的性能优于TCP?](#udp一般比tcp快但根据交换数据的特点其差异可大可小请说明何种情况下udp的性能优于tcp)
5. [客户端TCP套接字调用connect函数时自动分配IP和端口号。UDP中不调用bind函数，那何时分配IP和端口号？](#客户端tcp套接字调用connect函数时自动分配ip和端口号udp中不调用bind函数那何时分配ip和端口号)
6. [TCP客户端必需调用connect函数，而UDP中可以选择性调用。请问，在UDP中调用connect函数有哪些好处？](#tcp客户端必需调用connect函数而udp中可以选择性调用请问在udp中调用connect函数有哪些好处)
7. [请参考本章给出的uecho server.c和uecho client.c,编写示例使服务器端和客户端轮流收发消息。收发的消息均要输出到控制台窗口](#请参考本章给出的uecho-serverc和uecho-clientc编写示例使服务器端和客户端轮流收发消息收发的消息均要输出到控制台窗口)

## UDP为什么比TCP速度快？为什么UDP比TCP传输数据不可靠？

UDP是面向无连接的不可靠的传输协议。UDP之所以比TCP更快，是因为UDP没有传输数据前的建立套接字和传输数据后的数据确认步骤、失败重传、拥堵控制管理等控制步骤。UDP不进行流量控制，相比于TCP减少了流程。另外，TCP传输的数据中会添加ACK和SEQ等标记数据包序号的数据，而UDP没有，所以UDP传输的数据中，元数据所占的比例更低，传输的效率更高。

UDP比TCP快的原因也是UDP比TCP不可靠的原因。因为UDP省略了数据传输控制的流程，所以当发生数据丢失、拥堵等情况时，UDP传输不能保证数据传输可靠。

## 下列不属于UDP特点的是?

    a.UDP不同于TCP,不存在连接的概念，所以不像TCP那样只能进行一对一的数据传输。

    b.利用UDP传输数据时，如果有2个目标，则需要2个套接字。

    c.UDP套接字中无法使用已分配给TCP的同一端口号。

    d.UDP套接字和TCP套接字可以共存。若需要，可以在同一主机进行TCP和UDP数据传输。

    e.针对UDP函数也可以调用connect函数，此时UDP套接字跟TCP套接字相同，也需要经过3次握手过程。

Answer: `b, c, e`

## UDP数据报向对方主机的UDP套接字传输过程中，IP和UDP分别负责哪些部分？

IP负责将数据报传输到指定的主机，数据报到了指定的主机后就由UDP根据目的主机的端口号将数据交给UDP套接字进行处理。

## UDP一般比TCP快，但根据交换数据的特点，其差异可大可小。请说明何种情况下UDP的性能优于TCP?

UDP和TCP不同，它不经历两个套接字之间的连接和断开的过程。因此，在需要频繁的连接和断开过程的情况下，基于UDP的数据收发比基于TCP的数据收发具有更好的性能。

<!-- 原来的回答：在传输数据量大时，TCP和UDP的传输速度比较接近；在数据量小的时候，UDP的性能优于TCP。 -->

## 客户端TCP套接字调用connect函数时自动分配IP和端口号。UDP中不调用bind函数，那何时分配IP和端口号？

UDP客户端不需要分套接字分配IP地址和端口号。在调用sendto时会将IP地址和端口的信息传递给套接字。

## TCP客户端必需调用connect函数，而UDP中可以选择性调用。请问，在UDP中调用connect函数有哪些好处？

通过sendto接口传输数据大概会经历三个阶段，1. 向UDP套接字注册目标IP地址和端口号；2.传输数据；3.删除UDP套接字中注册的目标地址信息。第一个阶段和第三个阶段占整个过程接近1/3的时间。

在UDP中调用connect函数可以重复使用IP地址和端口号信息，从而提高整体的传输性能。调用connect函数后，也可以通过write、read函数的调用来发送和接受数据。

## 请参考本章给出的uecho server.c和uecho client.c,编写示例使服务器端和客户端轮流收发消息。收发的消息均要输出到控制台窗口

`见: udp_chat_server.c udp_chat_client.c`
